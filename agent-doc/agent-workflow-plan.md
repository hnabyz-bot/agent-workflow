# AI 에이전트 협업 워크플로우 (개정 최종판)

## 1. 이 문서의 정체성과 핵심 원칙

**⚠️ 중요: 이 문서는 'AI 자율 협업 시스템'이 아닌, '사람(개발자)을 위한 AI 활용 매뉴얼'입니다.**

이 문서는 각기 다른 강점을 가진 AI 에이전트(Claude, Gemini, Copilot)를 사람이 가장 효율적으로 활용하여, 복잡한 소프트웨어 프로젝트를 수행하는 방법을 안내합니다.

### 1.1. 핵심 운영 원칙
1.  **사람 중심 중재 (Human-in-the-Loop):** 모든 협업은 사람이 중심이 되어 각 에이전트에게 작업을 지시하고, 그 결과를 다음 에이전트에게 전달하는 방식으로 이루어집니다. AI 간의 직접적인 대화나 자동 협업은 불가능합니다.
2.  **순차 활용 우선 (Sequential First):** 기본적으로 하나의 작업은 하나의 주력 에이전트가 순차적으로 처리합니다.
3.  **전략적 호출 (Strategic Intervention):** 아키텍처 검토, 고난도 알고리즘 설계 등 명확한 목적이 있는 전략적 지점에서만 다른 에이전트를 제한적으로 호출하여 품질을 높입니다.
4.  **상태 관리 생활화 (State Management):** `project_status.md` 파일을 통해 프로젝트의 컨텍스트를 지속적으로 관리하여, 에이전트 전환 시 발생하는 정보 손실을 최소화합니다.
    *   **목적**: 프로젝트의 현재 상태, 주요 산출물, 다음 작업을 기록하는 단일 진실 공급원 (Single Source of Truth).
    *   **운영 방식**:
        1.  **운영자는** 하나의 Agent 작업이 끝날 때마다 이 파일을 **수동으로 업데이트**합니다.
        2.  다음 Agent에게 작업을 요청할 때, **항상 이 파일을 컨텍스트의 일부로 포함**하여 전달합니다.
    *   **상세 템플릿**:
        ```markdown
        # Project Status: [Project Name]
        _Last Updated: YYYY-MM-DD HH:MM (Operator Name)_

        ## 1. Current Milestone & Objective
        - **Phase:** 2 (구현)
        - **Milestone:** 2-1 (User Service CRUD)
        - **Objective:** 사용자 CRUD API 기본 기능 구현 및 단위 테스트 통과

        ## 2. Key Artifacts & Location
        - **Plan:** `agent-doc/plan_v3.md`
        - **Source Code:** `src/services/user_service.py`
        - **Test Code:** `tests/test_user_service.py`

        ## 3. Last Action Summary
        - **Agent:** Gemini
        - **Action:** `user_service.py`의 동시성 제어 로직에 대한 의사 코드를 제공함.

        ## 4. Next Action
        - **Agent:** Copilot
        - **Objective:** Gemini가 제공한 의사 코드를 `user_service.py`에 실제 코드로 구현하고, 관련 단위 테스트를 통과시킬 것.
        ```
5.  **품질 게이트 (Quality Gates):** 각 단계의 산출물은 다음 단계로 넘어가기 전, '산출물 승인 체크리스트'를 통해 품질을 검증합니다.
6.  **상세 규칙 및 가이드 준수 (Adherence to Detailed Rules):** 본 워크플로우의 구체적인 팀 운영 규칙은 `team_ground_rules.md` 문서를 따릅니다.

---

## 2. 에이전트 소개 및 역할 정의

| 에이전트 | 핵심 강점 | 주요 역할 (Owner) |
| :--- | :--- | :--- |
| **Claude** | 체계적인 장문 생성, 계획 수립 | **기획자 (Planner) / 기술 작가 (Writer)** |
| **Gemini** | 심층 분석, 추론, 아키텍처 설계 | **아키텍트 (Architect) / 분석가 (Analyst)** |
| **Copilot** | 빠른 코드 생성, 실행, 자동화 | **구현자 (Implementer) / 실행자 (Executor)** |

---

## 3. 단계별 운영 가이드 (사용자 매뉴얼)

### Phase 0: 기술 검증 (1-2시간)
> **목표:** 아이디어나 기술 스택의 실현 가능성을 빠르게 확인합니다.

| 작업 | 주관 | 상세 지침 (사용자 행동) |
| :--- | :--- | :--- |
| 1. PoC 개발 | **Copilot** | **To Copilot:** "이 기술(e.g., gRPC)을 사용해서, 사용자 인증을 처리하는 간단한 PoC를 30분 안에 작성해줘." 와 같이 구체적인 목표와 시간제한을 명시하여 요청합니다. |
| 2. 기술 검토 | **Gemini** | (선택 사항) Copilot의 PoC 코드를 Gemini에게 전달하고, 사용된 기술의 적합성이나 더 나은 대안이 있는지 검토를 요청합니다. |

### Phase 1: 분석 및 전략 수립 (1-2일)
> **목표:** 요구사항을 구체화하고, 검증된 기술 계획을 수립합니다.

| 작업 | 주관 | 상세 지침 (사용자 행동) |
| :--- | :--- | :--- |
| 1. 계획 초안 | **Claude** | **To Claude:** "다음 요구사항과 제약조건에 맞춰, 상세 기술 계획, WBS, 리스크 분석이 포함된 계획 문서를 만들어줘. [요구사항...], [제약조건...]" 형식으로 요청합니다. |
| 2. 설계/전략 검토 | **Gemini** | **[핸드오프 1]** **To Gemini:** "첨부한 `project_status.md`와 계획서를 바탕으로, 아키텍처의 문제점, 숨겨진 기술 부채, 그리고 테스트 전략을 제안해줘." 형식으로 요청합니다. |
| 3. 실행 검증 | **Copilot** | **[핸드오프 2]** **To Copilot:** "첨부한 `project_status.md`와 최종 계획서를 바탕으로, 핵심 API 1~2개를 코드로 구현해서 실제 작동하는지 30분 안에 검증해줘." 형식으로 요청합니다. |

### Phase 2: 마일스톤 기반 구현 (1-3주)
> **목표:** 기능 단위 마일스톤을 반복하여 실제 코드를 개발합니다.

| 작업 | 주관 | 상세 지침 (사용자 행동) |
| :--- | :--- | :--- |
| 1. 테스트 전략 | **Gemini** | (마일스톤 시작 시) **To Gemini:** "이번 마일스톤의 기능은 [기능 요약]이야. 테스트 커버리지 목표(e.g., 80%)와 중점적으로 검증할 시나리오(e.g., 동시성, 예외처리)를 포함한 테스트 전략을 제안해줘." |
| 2. 테스트 설계 | **Claude** | **To Claude:** "첨부한 테스트 전략에 맞춰, 주요 기능에 대한 BDD 스타일 테스트 케이스 뼈대를 작성해줘." |
| 3. 설계/구현 | **Copilot** | **[핵심 작업] To Copilot:** "첨부한 설계와 테스트 케이스 뼈대를 바탕으로 실제 코드를 구현하고, 모든 테스트를 통과시켜줘. 막히는 설계 문제가 발생하면 즉시 보고해." |
| 4. 동기화 | **Claude** | (마일스톤 종료 시) Copilot이 제공한 변경 요약(git log 기반)을 바탕으로 관련 문서를 업데이트합니다. |

### Phase 3: 최종화 및 문서화 (3-5일)
> **목표:** 프로젝트를 최종 완료하고, 산출물을 정리합니다.

| 작업 | 주관 | 상세 지침 (사용자 행동) |
| :--- | :--- | :--- |
| 1. DevOps/배포 | **Copilot** | **To Copilot:** "이 프로젝트를 위한 GitHub Actions CI/CD 파이프라인과 Dockerfile을 생성해줘. 최종 빌드와 테스트를 실행해서 검증해." |
| 2. 최종 검수 | **Gemini** | **[핸드오프 3]** 모든 산출물을 최종 검수하고, Claude의 문서 작성을 돕기 위한 '핵심 정보 요약'을 생성합니다. |
| 3. 최종 문서화 | **Claude** | Gemini의 요약과 Copilot의 최종 변경 로그를 바탕으로, 사용자 매뉴얼, API 명세 등 최종 문서를 작성합니다. |

---

## 4. 부록: 핸드오프 프로토콜 및 실무 가이드 🆕

> **참고:** 이 섹션은 사용자가 각 Agent에게 작업을 전달할 때 사용하는 구체적인 체크리스트, 템플릿, 그리고 실무 팁을 포함합니다.

### 4.1. 핸드오프 프로토콜 (체크리스트 및 템플릿)

#### **[핸드오프 1] Claude → Gemini**
*   **목표:** 계획의 기술적 타당성을 심층 검증합니다.
*   **산출물 승인 체크리스트 (Claude 결과물):**
    *   `[ ]` 모든 주요 요구사항이 반영되었는가?
    *   `[ ]` 리스크 평가 항목이 포함되었는가?
    *   `[ ]` 작업 분할(WBS) 초안이 포함되었는가?
*   **프롬프트 템플릿 (Gemini 요청 시):**
    ```
    To: Gemini
    Context: `project_status.md` 참조
    Artifact: `plan_v1.md` (Claude 작성)

    Objective:
    1. 이 계획의 아키텍처 타당성을 검토해줘.
    2. 숨겨진 기술 부채나 시스템 전체에 영향을 줄 이슈(횡단 관심사)를 분석해줘.
    3. 테스트 전략과 커버리지 목표를 수립해줘.
    ```

#### **[핸드오프 2] Gemini/Claude → Copilot**
*   **목표:** 최종 계획의 실행 가능성을 코드로 검증합니다.
*   **산출물 승인 체크리스트 (Gemini/Claude 결과물):**
    *   `[ ]` 검토 의견이 반영된 최종 계획서가 준비되었는가?
*   **프롬프트 템플릿 (Copilot 요청 시):**
    ```
    To: Copilot
    Context: `project_status.md` 참조
    Artifact: `plan_final.md`

    Objective:
    1. 이 계획의 핵심 API 1~2개를 실제 코드로 구현하여 실현 가능성을 검증해줘. (30분 내외)
    2. 구현 중 발견되는 문제점(설계 오류, 의존성 충돌 등)을 보고해줘.
    ```

#### **[핸드오프 3] 모든 산출물 → Gemini**
*   **목표:** 프로젝트 최종 산출물을 종합 검수합니다.
*   **산출물 승인 체크리스트 (Copilot/Claude 결과물):**
    *   `[ ]` 모든 테스트가 통과했는가? (Copilot)
    *   `[ ]` 최종 빌드가 성공했는가? (Copilot)
    *   `[ ]` 기능 구현이 완료되었는가? (Copilot)
*   **프롬프트 템플릿 (Gemini 요청 시):**
    ```
    To: Gemini
    Context: `project_status.md`, 최종 소스코드 전체, 테스트 결과

    Objective:
    1. 모든 산출물을 종합적으로 검수하고 일관성을 확인해줘.
    2. 기술 부채 목록과 향후 개선 권장사항을 정리해줘.
    3. 코드 분석 기반의 보안 리뷰를 수행해줘.
    4. 최종 검수 후, Claude가 문서를 작성하는 데 필요한 핵심 정보를 요약해줘. (API 최종 명세, 주요 변경점, 코드 예제 등)
    ```

---

## 5. 팀 규모별 전략

### 1인 개발자
```
Phase 0: Copilot PoC (생략 가능)
Phase 1: Claude 계획 (검증 생략)
Phase 2: Copilot 구현 (막힐 때만 Gemini)
Phase 3: Claude 문서화
```
**오버헤드**: 10%  
**권장**: 순차 활용 우선, Agent 전환 최소화

### 2-5인 팀
```
Phase 0: Copilot → Gemini 검증
Phase 1: Claude → Gemini 검토 → Copilot 검증
Phase 2: Copilot 주도 + Gemini 선택적 호출
Phase 3: Copilot DevOps + Claude 문서 + Gemini 검수
```
**오버헤드**: 25%  
**효율 증가**: +40-50%  
**권장**: 품질 게이트 엄격 적용

### 10인 이상 팀
```
팀 1: Claude (계획/문서 전담)
팀 2: Copilot (Module A 구현)
팀 3: Copilot (Module B 구현)
팀 4: Gemini (리뷰/분석 전담)
```
**오버헤드**: 30%  
**효율 증가**: +60-70%  
**권장**: project_status.md 팀별 관리

---

## 6. 실무 체크리스트

### Agent 전환 시 체크리스트

**Claude → Gemini 전환 시**:
```
[ ] Claude 결과물 전체 복사
[ ] "이 계획의 기술적 타당성 검토" 명시
[ ] project_status.md 함께 첨부
[ ] Gemini 피드백 중 변경 필요 부분만 추출
[ ] Claude에게 재요청
```

**Gemini → Copilot 전환 시**:
```
[ ] Gemini 설계 + 의사코드 복사
[ ] "이 설계를 파일로 구현" 명시
[ ] 파일 경로 명확히 지정
[ ] 구현 후 get_errors로 검증
```

**Copilot → Claude 전환 시**:
```
[ ] 모든 테스트 통과 확인
[ ] Git 커밋 히스토리 정리
[ ] API 변경사항 요약 작성
[ ] 주요 버그 픽스 내역 정리
```

### 컨텍스트 손실 방지

**Git 커밋 메시지 작성 규칙**:
```bash
git commit -m "Add: UserService CRUD
(Claude 테스트 케이스 통과, Gemini 설계 반영)"
```

**Sprint 요약 템플릿** (Copilot 자동 생성):
```markdown
# Sprint N 요약
- 변경 파일: [git diff --name-only]
- 추가 기능: [3줄 요약]
- 다음 입력: [이 요약 + 새 요구사항]
```

---

## 7. 함정 회피 가이드

### ❌ 하지 말 것

1. **한 번에 100개 파일 수정 요청**
   - 결과: 컨텍스트 초과, 불완전한 수정
   - 해결: 10개씩 나눠 요청 + 중간 검증

2. **추상적 요청**
   - "코드 개선해줘" ❌
   - "UserService.ts 에러 핸들링 추가 (try-catch)" ✅

3. **컨텍스트 없는 에러 보고**
   - "에러 났어요" ❌
   - "Phase 2-3, UserService 테스트 실패: [로그 전문]" ✅

4. **과도한 Agent 전환**
   - Claude → Gemini → Copilot → Claude (1시간 내) ❌
   - 한 Agent에게 집중 → 막힐 때만 전환 ✅

### ✅ 할 것

1. **명확한 Phase/Activity 명시**
   ```
   "Phase 2-1, UserService CRUD 구현 중
   현재: Create/Read 완료, Update 진행 중
   막힘: 동시성 처리 설계 필요"
   ```

2. **project_status.md 활용**
   - 매 마일스톤마다 업데이트
   - 모든 Agent 요청 시 첨부

3. **품질 게이트 준수**
   - 테스트 통과 전 다음 단계 금지
   - get_errors로 오류 확인 필수

---

## 8. 최종 권장사항

### 성공의 핵심
1. ✅ **순차 활용 기본** (한 Agent에게 집중)
2. ✅ **선택적 협업** (막힐 때만)
3. ✅ **project_status.md 활용** (컨텍스트 유지)
4. ✅ **품질 게이트 준수** (단계별 검증)
5. ✅ **25% 오버헤드 수용** (품질 향상으로 상쇄)

### 실패 방지
1. ❌ **자동 협업 기대하지 말 것**
2. ❌ **과도한 Agent 전환 피할 것**
3. ❌ **컨텍스트 없는 요청 금지**
4. ❌ **100개 파일 한 번에 수정 금지**

---

**작성 기준**: 4개 Agent 합의 (Claude, Gemini, Copilot, Perplexity)  
**실현 가능성**: 70%  
**검증 프로젝트**: Agent Workflow 문서 작업 (실전 데이터 기반)  
**개정 일자**: 2026-01-08

### 4.2. 실무 팁 및 함정 회피 🆕

*   **❌ 하지 말아야 할 요청:**
    *   **과도하게 큰 작업 단위:** "100개 파일 전체를 리팩토링해줘"
    *   **추상적인 목표:** "코드를 더 좋게 만들어줘"
    *   **컨텍스트 없는 에러 보고:** "에러가 발생했어, 수정해줘"

*   **✅ 권장하는 요청 방식:**
    *   **작업 분할:** "A, B, C 모듈 순서로 각각 리팩토링해줘. 먼저 A 모듈부터."
    *   **구체적인 지시:** "`UserService.ts` 파일에 `try-catch`를 사용한 에러 핸들링 로직을 추가해줘."
    *   **상세한 컨텍스트 제공:** "Phase 2-1, UserService 구현 중. `test_create_user` 테스트 실패. 관련 코드와 에러 로그는 다음과 같아: [코드 및 로그 첨부]"

*   **컨텍스트 손실 방지 팁:**
    *   **Git 커밋 메시지 상세화:** 다음 Agent가 `git log`만 봐도 작업 내용을 추측할 수 있도록, 커밋 메시지에 담당 Agent, 작업 근거(e.g., Gemini 설계 반영)등을 상세히 기록합니다.
    *   **요약 템플릿 활용:** 마일스톤 종료 시, Copilot이 생성한 변경 요약(추가/수정된 파일, 주요 기능)을 다음 마일스톤의 컨텍스트에 필수로 포함합니다.